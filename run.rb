require_relative('getty_scraper')
require_relative('image_annotater')

INITIAL_DIRECTORY = "raw_images"
ANNOTATED_DIRECTORY = "annotated_images"

@scraper = GettyScraper.new
@annotater = ImageAnnotater.new

# http://search.getty.edu/gateway/search?q=&cat=type&r=%22Periodical%22&types=%22Periodical$Photographs%22&rows=7&srt=a&dir=s&dsp=0&img=0&pg=1
# ids = ["928", "136094", "1488", "144722", "926", "937", "765", "791", "834", "111114", "8162", "723", "7662", "900", "1312", "608", "136166", "244856", "1464", "758", "9522", "761", "1361", "140731", "140425", "8234", "918", "9920", "771", "555", "839", "553", "939", "136718", "110810", "1456", "1338", "604", "943", "10422", "781", "11077", "576", "11098", "830", "814", "539", "113646", "113645", "1305", "787", "1470", "925", "38171", "9726", "733", "924", "875", "1521", "695", "1436", "930", "310277", "8240", "681", "1326", "622", "6831", "144721", "922", "662", "856", "642", "646", "641", "1400", "541", "889", "890", "914", "832", "1046", "852", "849", "145135", "8049", "584", "15228", "862", "12351", "739", "1027", "845", "1145", "942", "597", "657", "803", "554", "8096", "760", "35448", "867", "7630", "258392", "258079", "904", "1401", "883", "666", "1358", "116389", "915", "1462", "1041", "8108", "1285", "12350", "836", "110998", "12935", "1489", "871", "1402", "821", "1137", "1261", "1364", "549", "1522", "112294", "12330", "8238", "7629", "15267", "1347", "1373", "697", "1472", "879", "1444", "1403", "1342", "12928", "1262", "866", "1390", "935", "1397", "1058", "12936", "8128", "1315", "1336", "138763", "245296", "313766", "1457", "1365", "113700", "1136", "1299", "133598", "241377", "593", "1307", "6707", "12843", "6700", "6827", "838", "940", "865", "1478", "831", "712", "1313", "899", "108653", "7608", "575", "948", "143336", "552", "301568", "324992", "138292", "135448", "805", "256871", "9072", "8171", "561", "306425", "802", "8041", "811", "590", "736", "827", "7665", "1139", "807", "9336", "682", "143586", "9910", "136096", "313767", "7654", "1070", "709", "9921", "571", "692", "1468", "312902", "700", "38169", "870", "780", "826", "850", "655", "15466", "631", "672", "851", "880", "1329", "15107", "330306", "896", "1475", "1349", "1408", "713", "1407", "1409", "1303", "1284", "727", "822", "192074", "140300", "749", "8046", "595", "8239", "1272", "15045", "8047", "15053", "15052", "929", "15064", "15054", "645", "15192", "8097", "1114", "1138", "7689", "9335", "12346", "1113", "7996", "842", "304250", "12937", "1513", "654", "7988", "140224", "38172", "15123", "38168", "38167", "573", "38170", "15055", "1465", "9887", "8230", "7598", "7625", "20398", "8109", "20448", "8024", "252638", "8026", "8028", "945", "8209", "548", "20315", "675", "8396", "8093", "11442", "818", "877", "8204", "627", "7590", "1043", "7589", "558", "8048", "789", "847", "634", "8100", "906", "8236", "623", "8101", "527", "8180", "792", "8331", "1467", "9073", "9311", "112252", "7990", "35442", "1528", "7817", "7833", "1035", "8200", "7672", "134718", "9310", "35632", "1304", "12708", "15195", "1066", "9926", "8061", "664", "252741", "810", "683", "1317", "35429", "113250", "35612", "1518", "1421", "12938", "12127", "113115", "12137", "788", "874", "7583", "7986", "579", "1068", "12930", "578", "1511", "144617", "572", "605", "1316", "12445", "1318", "9917", "311978", "9913", "7671", "34126", "891", "1348", "1302", "12130", "919", "1289", "820", "146004", "8398", "801", "1368", "113695", "611", "1350", "663", "748", "745", "882", "594", "947", "108665", "859", "112007", "1512", "110330", "884", "248780", "1051", "1410", "864", "1362", "1450", "680", "1466", "872", "869", "1294", "763", "8066", "8112", "12908", "12126", "772", "113640", "8067", "643", "648", "7643", "835", "587", "15199", "644", "603", "7617", "860", "671", "7618", "670", "912", "7995", "305319", "7882", "1319", "944", "7597", "113647", "1463", "8912", "7638", "598", "8133", "613", "136958", "7639", "35556", "7562", "737", "24254", "574", "7569", "7696", "140223", "8228", "14872", "111977", "35437", "7678", "22024", "9591", "12858", "12929", "7721", "8118", "15113", "7683", "7585", "7564", "35644", "15049", "7682", "8175", "22023", "35493", "7593", "7727", "8911", "35424", "35445", "12859", "9319", "9262", "8392", "8034", "632", "710", "854", "109325", "141982", "649", "888", "525", "220364", "828", "562", "908", "911", "913", "336341", "711", "819", "577", "596", "690", "898", "635", "265216", "812", "777", "133580", "887", "588", "551", "1487", "1371", "691", "7642", "936", "1069", "8129", "741", "1405", "591", "767", "714", "796", "910", "253268", "1089", "774", "782", "582", "735", "886", "335657", "799", "853", "797", "1270", "693", "1435", "112575", "638", "823", "303448", "934", "923", "679", "873", "8035", "674", "905", "660", "1271", "878", "323345", "628", "800", "1333", "144484", "563", "916", "12934", "793", "12549", "806", "653", "894", "895", "556", "798", "917", "267599", "892", "217373", "1533", "846", "813", "317722", "535", "1036", "794", "920", "844", "696", "217374", "1047", "1034", "931", "265193", "1301", "927", "876", "135093", "652", "858", "265346", "266546", "647", "658", "1086", "633", "656", "885", "335970", "843", "734", "868", "560", "1091", "258077", "1062", "960", "112253", "665", "848", "704", "113249", "708", "536", "1534", "938", "142049", "897", "689", "109413", "933", "135434", "946", "699", "694", "857", "840", "804", "907", "863", "610", "614", "903", "687", "108697", "335959", "740", "305049", "901", "136125", "881", "1044", "941", "244447", "841", "744", "909", "1090", "8051", "7976", "12379", "15465", "540", "705", "1320", "816", "1049", "742", "743", "817", "1360", "1451", "1030", "636", "1359", "659", "855", "661", "113424", "724", "308596", "784", "621", "755", "990", "235718", "861", "1179", "9312", "9337", "8207", "8167", "35453", "7609", "8019", "8010", "1147", 1088 ]

def save_and_annotate!(id)
  initial_path = "#{INITIAL_DIRECTORY}/#{id}.jpg"
  annotated_path = "#{ANNOTATED_DIRECTORY}/#{id}"
  info = @scraper.load_info(id)
  image = @scraper.download_image(id)
  @scraper.save_image(image, initial_path)
  @annotater.annotate(initial_path, info).write(annotated_path)
  rescue Exception => e; puts e # Don't Care
end

ids = ["136094", "928"]
ids.each{ |id| save_and_annotate!(id) }
